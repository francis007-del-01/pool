pool:
  name: "example-pool"
  version: "1.0"
  syntax-used: CONDITION_TREE

  # Queue configurations (shared by scheduler and executors)
  scheduler:
    queues:
      - name: "fast"
        index: 0
        capacity: 1000
      - name: "bulk"
        index: 1
        capacity: 500

  # Adapter configurations - executors reference queue names
  adapters:
    executors:
      - queue_name: "fast"
        worker_count: 10
        keep-alive-seconds: 60
        allow-core-thread-timeout: true

      - queue_name: "bulk"
        worker_count: 5
        keep-alive-seconds: 120
        allow-core-thread-timeout: true

  # Priority Strategy Configuration
  priority-strategy:
    type: FIFO

  # Priority tree - routes tasks to queues at leaf nodes
  priority-tree:
    # Level 1: Region-based routing
    - name: "L1.NORTH_AMERICA"
      condition:
        type: EQUALS
        field: $req.region
        value: "NORTH_AMERICA"
      nested-levels:
        # Level 2: Customer tier
        - name: "L2.PLATINUM"
          condition:
            type: EQUALS
            field: $req.customerTier
            value: "PLATINUM"
          nested-levels:
            # Level 3: Transaction amount
            - name: "L3.HIGH_VALUE"
              condition:
                type: GREATER_THAN
                field: $req.transactionAmount
                value: 100000
              sort-by:
                field: $req.priority
                direction: DESC
              queue: "fast"  # Route to fast queue

            - name: "L3.DEFAULT"
              condition:
                type: ALWAYS_TRUE
              sort-by:
                field: $req.urgency
                direction: DESC
              queue: "fast"

        - name: "L2.GOLD"
          condition:
            type: EQUALS
            field: $req.customerTier
            value: "GOLD"
          nested-levels:
            - name: "L3.DEFAULT"
              condition:
                type: ALWAYS_TRUE
              sort-by:
                field: $sys.submittedAt
                direction: ASC
              queue: "fast"

        - name: "L2.DEFAULT"
          condition:
            type: ALWAYS_TRUE
          nested-levels:
            - name: "L3.DEFAULT"
              condition:
                type: ALWAYS_TRUE
              sort-by:
                field: $sys.submittedAt
                direction: ASC
              queue: "bulk"  # Route to bulk queue

    - name: "L1.EUROPE"
      condition:
        type: EQUALS
        field: $req.region
        value: "EUROPE"
      nested-levels:
        - name: "L2.DEFAULT"
          condition:
            type: ALWAYS_TRUE
          nested-levels:
            - name: "L3.DEFAULT"
              condition:
                type: ALWAYS_TRUE
              sort-by:
                field: $req.priority
                direction: DESC
              queue: "fast"

    # Catch-all for other regions
    - name: "L1.DEFAULT"
      condition:
        type: ALWAYS_TRUE
      nested-levels:
        - name: "L2.DEFAULT"
          condition:
            type: ALWAYS_TRUE
          nested-levels:
            - name: "L3.DEFAULT"
              condition:
                type: ALWAYS_TRUE
              sort-by:
                field: $sys.submittedAt
                direction: ASC
              queue: "bulk"  # Default to bulk queue
